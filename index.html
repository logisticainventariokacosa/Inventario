<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Log√≠stica & Inventario</title>
    <!-- Favicon completo -->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/x-icon" href="Img/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="Img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="Img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="Img/favicon-16x16.png">
    <link rel="manifest" href="Img/site.webmanifest">
 
    <style>
/* === VARIABLES DE DISE√ëO Y RESET === */
:root{
    --red:#e53935;--dark-red:#c62828;--black:#121212;--bg:#0a0a0a;
    --text:#f5f5f5;--muted:#9e9e9e;--card-bg:#1a1a1a;
    --card-news:#1a1f23;--accent:#2196F3;--success:#4caf50;
    --blue-accent:#2196F3;--teal-accent:#009688;--orange-accent:#FF9800;
    --gradient:linear-gradient(135deg, #e53935 0%, #2196F3 100%);
    --gradient-alt:linear-gradient(135deg, #2196F3 0%, #009688 100%);
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
    font-family:'Segoe UI', system-ui, Arial, sans-serif;
    background:
        linear-gradient(rgba(10, 10, 10, 0.85), rgba(10, 10, 10, 0.9)), 
        url('Img/fondo1.jpg') no-repeat fixed center center / cover;
    color:var(--text);
    min-height:100vh;
    line-height:1.6;
    letter-spacing:0.01em;
}

/* === AUTH SCREEN === */
.auth-screen{
    display:flex;
    align-items:center;
    justify-content:center;
    height:100vh;
    padding:16px;
    background:radial-gradient(circle at center, #1a1a1a 0%, #0a0a0a 100%);
}
.card.auth-card{
    background:linear-gradient(145deg, #1e1e1e, #151515);
    border-radius:16px;
    padding:32px;
    width:100%;
    max-width:420px;
    box-shadow:0 15px 35px rgba(0,0,0,0.5);
    border:1px solid rgba(255,255,255,0.05);
    text-align:center;
    backdrop-filter:blur(10px);
}
.auth-card h1{
    margin-bottom:8px;
    font-size:24px;
    background:var(--gradient);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    font-weight:700;
}
.muted{color:var(--muted);font-size:0.9rem;}

/* Contenedor para el input y el bot√≥n de toggle (para la contrase√±a) */
.password-container {
    position: relative;
    width: 100%;
}

.auth-card input{
    width:100%;
    padding:12px 16px;
    margin:10px 0;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.08);
    background:rgba(255,255,255,0.03);
    color:var(--text);
    font-size:1rem;
    transition:all 0.3s ease;
}
.auth-card input:focus{
    border-color:var(--blue-accent);
    outline:none;
    box-shadow:0 0 0 2px rgba(33, 150, 243, 0.2);
    background:rgba(255,255,255,0.05);
}

/* Ajuste para que el input dentro del contenedor de contrase√±a no tenga doble margen */
.password-container input {
    margin: 10px 0; 
    padding-right: 50px; 
}

/* Estilo para el bot√≥n de alternar visibilidad */
.toggle-password {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    color: var(--muted);
    font-size: 1.2rem;
    padding: 0;
    line-height: 1;
    z-index: 10;
    transition: color 0.2s;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
}
.toggle-password:hover {
    color: var(--blue-accent);
    background: rgba(255,255,255,0.05);
}

.row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
button{
    background:var(--gradient);
    border:0;
    padding:12px 20px;
    border-radius:10px;
    color:white;
    cursor:pointer;
    transition:all 0.3s ease;
    font-weight:600;
    font-size:0.95rem;
    flex:1;
    min-width:120px;
}
button.alt{
    background:transparent;
    border:1px solid rgba(255,255,255,0.1);
    color:var(--text);
}

/* === BOT√ìN GOOGLE MEJORADO CON EFECTO PULSANTE Y MARCO === */
button.google{
    background:#fff;
    color:#222;
    border:1px solid rgba(255,255,255,0.1);
    position:relative;
    overflow:hidden;
    animation: pulse 2s infinite;
    box-shadow:0 0 0 0 rgba(33, 150, 243, 0.7);
}

/* Efecto de marco animado - Colores azules y verdes */
button.google::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, #2196F3, #1976D2, #0D47A1, #00695C, #004D40, #00796B);
    background-size: 400%;
    z-index: -1;
    border-radius: 12px;
    animation: steam 20s linear infinite;
    opacity: 0;
    transition: opacity 0.3s ease;
}

button.google:hover::before {
    opacity: 1;
}

button.google:hover {
    animation: none;
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(33, 150, 243, 0.4);
}

@keyframes steam {
    0% {
        background-position: 0 0;
    }
    50% {
        background-position: 400% 0;
    }
    100% {
        background-position: 0 0;
    }
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.7);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(33, 150, 243, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(33, 150, 243, 0);
    }
}

button:hover{
    transform:translateY(-3px);
    box-shadow:0 10px 20px rgba(198,40,40,0.3);
}
button.alt:hover{
    background:rgba(255,255,255,0.05);
    box-shadow:0 5px 15px rgba(0,0,0,0.2);
    border-color:var(--blue-accent);
}
.hidden{display:none}

/* === TOPBAR / NAV MODIFICADO === */
.topbar{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:14px 24px;
    background:linear-gradient(90deg,rgba(20,20,20,0.95),rgba(26,26,26,0.98));
    border-bottom:1px solid rgba(255,255,255,0.05);
    position:sticky;
    top:0;
    z-index:100;
    backdrop-filter:blur(10px);
}
.brand{
    font-weight:800;
    background:var(--gradient);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    margin-right:10px;
    font-size:1.3rem;
    letter-spacing:-0.5px;
}
.nav{display:flex;align-items:center;gap:16px;flex:1;justify-content:space-between;flex-wrap:wrap}

/* Estilo de los botones de navegaci√≥n */
.nav.menu{display:flex;gap:6px;flex-wrap:wrap;align-items:center}

/* REGLA CR√çTICA: Asegura color blanco y sin subrayado en todos los estados */
.nav .menu a, 
.nav .menu a:visited,
.nav .menu a:link { 
    color:var(--text) !important; 
    text-decoration:none !important; 
    padding:10px 16px; 
    border-radius:10px;
    transition:all 0.3s ease;
    position:relative;
    font-weight:500;
    font-size:0.95rem;
}

/* Estilo para el bot√≥n hover (al pasar el rat√≥n) */
.nav .menu a:hover{ 
    color:var(--blue-accent) !important; 
    background:rgba(255, 255, 255, 0.05);
    transform:translateY(-2px);
}

/* Estilo para el bot√≥n activo (secci√≥n actual) */
.nav .menu a.active{
    color:var(--blue-accent) !important; 
    font-weight:600;
    background:rgba(33, 150, 243, 0.1); 
    border: 1px solid rgba(33, 150, 243, 0.2);
    box-shadow: 0 5px 15px rgba(33, 150, 243, 0.2); 
}

.nav.user-info{display:flex;align-items:center;gap:12px}
.user-info span{color:var(--muted);font-size:0.95rem;max-width:220px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ghost{
    background:rgba(255,255,255,0.05);
    border:1px solid rgba(255,255,255,0.08);
    padding:8px 14px;
    border-radius:8px;
    color:var(--muted);
    transition:all 0.3s ease;
    font-size:0.9rem;
}
.ghost:hover{
    background:rgba(255,255,255,0.1);
    color:var(--blue-accent);
    transform:translateY(-2px);
    border-color:var(--blue-accent);
}

/* === CONTENIDO PRINCIPAL === */
.container{
    max-width: 1200px;
    margin: 0 auto; 
    padding: 24px; 
    display:grid;
    grid-template-columns:1fr;
    gap:24px;
    width: 100%;
}

/* === CONTROL DE VISIBILIDAD DE SECCIONES === */
.section {
    display: none;
    width: 100%;
}

.active-section {
    display: block;
    width: 100%;
}

/* Asegurar que solo la secci√≥n activa se muestre */
.container > .section:not(.active-section) {
    display: none !important;
}

.container > .section.active-section {
    display: block !important;
}

/* === CENTRADO MEJORADO PARA SECCIONES ESPEC√çFICAS === */
#home {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
}

#news {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
}

#contact {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    width: 100%;
}

/* Centrar contenido espec√≠fico de contacto */
#contact > * {
    max-width: 600px;
    width: 100%;
    margin: 0 auto;
}

.search-card{
    background:var(--card-bg);
    padding:24px;
    border-radius:16px;
    border:1px solid rgba(255,255,255,0.05);
    box-shadow:0 8px 25px rgba(0,0,0,0.25);
    backdrop-filter:blur(5px);
    width: 100%;
    max-width: 900px; /* Reducido para mejor centrado */
    margin: 0 auto;
}
.search-card h2{
    margin-bottom:16px;
    font-size:1.5rem;
    color:var(--text);
    font-weight:600;
    text-align: center;
}
.search-card input{
    flex:1;
    padding:12px 16px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.08);
    background:rgba(255,255,255,0.03);
    color:var(--text);
    transition:all 0.3s ease;
    font-size:1rem;
}
.search-card input:focus{
    border-color:var(--blue-accent);
    outline:none;
    box-shadow:0 0 0 2px rgba(33, 150, 243, 0.2);
    background:rgba(255,255,255,0.05);
}
.search-card.row{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    align-items:center;
    width: 100%;
}
.results{
    margin-top:20px;
    background:rgba(255,255,255,0.02);
    border-radius:12px;
    min-height:40px;
    overflow-x:auto;
    border:1px solid rgba(255,255,255,0.03);
    width: 100%;
}

/* === MEJORAS ESPEC√çFICAS PARA TABLA DE INVENTARIO === */
.table-container {
    overflow-x: auto;
    margin: 20px 0;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.05);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    width: 100%;
}

.inventory-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    font-size: 0.9rem;
    background: var(--card-bg);
    border: 1px solid rgba(255,255,255,0.1);
    min-width: 600px;
}

.inventory-table th {
    background: linear-gradient(180deg, #252525, #1a1a1a);
    color: var(--blue-accent);
    font-weight: 600;
    padding: 14px 10px;
    text-align: left;
    border-bottom: 2px solid rgba(33, 150, 243, 0.4);
    border-right: 1px solid rgba(255,255,255,0.1);
    white-space: nowrap;
    position: sticky;
    top: 0;
    z-index: 10;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
}

.inventory-table th:last-child {
    border-right: none;
}

.inventory-table td {
    padding: 12px 10px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    border-right: 1px solid rgba(255,255,255,0.08);
    vertical-align: top;
    line-height: 1.5;
}

.inventory-table td:last-child {
    border-right: none;
}

/* SOLUCI√ìN ESPEC√çFICA: Manejo de descripciones largas */
.inventory-table td:nth-child(2) { /* Columna de descripci√≥n */
    max-width: 300px;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: normal;
}

/* SOLUCI√ìN 1: Diferencias negativas en amarillo */
.inventory-table td.negative-diff {
    color: #FFD700 !important; /* Amarillo dorado */
    font-weight: 600;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 4px;
}

.inventory-table tr:hover {
    background: rgba(33, 150, 243, 0.08);
    transform: scale(1.002);
    transition: all 0.2s ease;
}

.inventory-table tbody tr:nth-child(even) {
    background: rgba(255,255,255,0.03);
}

.inventory-table tbody tr:nth-child(even):hover {
    background: rgba(33, 150, 243, 0.12);
}

/* Estilos espec√≠ficos para columnas */
.inventory-table td:first-child {
    font-weight: 600;
    color: #e0e0e0;
    font-family: 'Courier New', monospace;
    white-space: nowrap;
}

.inventory-table td:nth-child(3),
.inventory-table td:nth-child(4) {
    white-space: nowrap;
    text-align: center;
}

/* Responsive para m√≥viles - MEJORADO */
@media (max-width: 768px) {
    .inventory-table {
        font-size: 0.75rem;
        min-width: 500px;
    }
    
    .inventory-table th,
    .inventory-table td {
        padding: 10px 6px;
    }
    
    .inventory-table td:nth-child(2) {
        max-width: 200px;
        font-size: 0.7rem;
        line-height: 1.4;
    }
    
    .table-container {
        border-radius: 8px;
    }
}

/* Scroll suave para la tabla */
.table-container {
    max-height: 600px;
    overflow-y: auto;
    border-radius: 12px;
}

/* === SOLUCI√ìN 3: Loading state restaurado === */
.loading-results {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.loading-results:before {
    content: "";
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 2px solid rgba(33, 150, 243, 0.3);
    border-radius: 50%;
    border-top-color: var(--blue-accent);
    animation: spin 1s ease-in-out infinite;
    vertical-align: middle;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* === GRID GENERAL (Documentos e Im√°genes) MODIFICADO === */
.grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); 
    gap:20px;
    margin-top:20px;
    width: 100%;
}
.card-item{
    background:var(--card-bg);
    padding:20px;
    border-radius:16px;
    text-align:center;
    min-height:200px;
    display:flex;
    flex-direction:column;
    justify-content:flex-start;
    border:1px solid rgba(255,255,255,0.05);
    transition:all 0.3s ease;
    box-shadow:0 5px 15px rgba(0,0,0,0.1);
    position:relative;
    overflow:hidden;
}
.card-item:before {
    content:"";
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:4px;
    background:var(--gradient-alt);
}
.card-item:hover{
    transform:translateY(-8px);
    box-shadow:0 15px 30px rgba(0,0,0,0.3);
    border-color:rgba(255,255,255,0.1);
}
.card-item img{
    max-width:100%;
    border-radius:10px;
    height:160px; 
    object-fit:cover;
    background:#111;
    margin-bottom:15px;
    transition:all 0.3s ease;
}
.card-item a{text-decoration:none}
.card-item a:hover img{
    opacity:0.8;
    transform:scale(1.03);
}

/* === NOTICIAS (Secci√≥n Inicio) MODIFICADO === */
.news-card-wrapper{
    display:grid;
    grid-template-columns:1fr; 
    gap:20px;
    padding:24px;
    background:var(--card-news);
    border-radius:16px;
    border:1px solid rgba(33, 150, 243, 0.1);
    box-shadow:0 8px 25px rgba(0,0,0,0.25);
    margin-top:24px;
    position:relative;
    overflow:hidden;
    width: 100%;
    max-width: 900px; /* Reducido para mejor centrado */
    margin: 24px auto 0;
}
.news-card-wrapper:before {
    content:"";
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:4px;
    background:var(--gradient-alt);
}
.news-card-wrapper h3{
    color:var(--blue-accent);
    margin-bottom:8px;
    font-size:1.5rem;
    font-weight:600;
    text-align: center;
}
.news-image-area{
    text-align:center;
    display:flex;
    flex-direction:column;
    gap:8px;
    align-items:center; /* Centrado mejorado */
}
.news-image-area img{
    width:100%;
    max-width:300px;
    height:auto;
    max-height:200px;
    object-fit:cover;
    border-radius:10px;
    margin:0; 
    box-shadow:0 5px 15px rgba(0,0,0,0.2);
}
.news-meta-data{
    font-size:0.85rem;
    color:var(--muted);
    text-align:center; /* Centrado mejorado */
}
.news-content-area{
    text-align: center;
}

/* Desktop: Main News a 2 columnas */
@media(min-width:900px){
    .container{grid-template-columns:1fr 420px}
    .search-card{grid-column:1}
    .news-card-wrapper{
        grid-column:1 / span 2; 
        grid-template-columns: auto 1fr; 
        align-items: flex-start;
        gap:24px;
    }
    .news-image-area {
        max-width: 320px;
    }
}
@media(min-width:1200px){
     .news-card-wrapper{
        grid-template-columns: 300px 1fr; 
     }
}

/* === NOTICIAS (Secci√≥n Noticias) MODIFICADO === */
.news-list .item{
    padding:20px;
    border-radius:16px;
    margin:16px 0;
    background:var(--card-bg);
    border:1px solid rgba(255,255,255,0.05);
    display:grid;
    grid-template-columns:1fr;
    gap:15px;
    align-items:flex-start;
    transition:all 0.3s ease;
    box-shadow:0 5px 15px rgba(0,0,0,0.1);
    position:relative;
    overflow:hidden;
    width: 100%;
    max-width: 900px; /* Reducido para mejor centrado */
    margin: 16px auto;
}
.news-list .item:before {
    content:"";
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:3px;
    background:var(--gradient-alt);
}
.news-list .item:hover {
    transform:translateY(-5px);
    box-shadow:0 10px 25px rgba(0,0,0,0.2);
    border-color:rgba(255,255,255,0.08);
}
.news-list .item strong{
    color:var(--blue-accent);
    font-size:1.2rem;
    font-weight:600;
    display:block;
    margin-bottom:5px;
}
.news-list .item small{
    color:var(--muted);
    display:block;
    margin-bottom:10px;
    font-size:0.85rem;
}
.news-list .item p{
    margin-top:0;
    font-size:1rem;
    line-height:1.6;
}
.news-list .item img{
    width:100%;
    max-width:220px;
    height:140px;
    object-fit:cover;
    border-radius:10px;
    float:left; 
    margin-right:15px;
    margin-bottom:10px;
    box-shadow:0 5px 15px rgba(0,0,0,0.2);
}

/* Desktop: Lista de noticias a 2 columnas */
@media(min-width:768px){
    .news-list .item{
        grid-template-columns: auto 1fr; 
        gap:20px;
    }
    .news-list .item img{
        max-width:200px;
        height:140px;
        float:none; 
        margin-right:0;
    }
    .news-list .item div:first-of-type{
        display: flex;
        flex-direction: column;
        padding-left: 10px;
    }
}

/* Placeholder/Inputs/Botones */
.placeholder{
    width:100%;
    height:160px;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#0b0b0b;
    color:var(--muted);
    border-radius:10px;
    font-size:14px;
    border:1px dashed rgba(255,255,255,0.1);
}
input[type=file]{
    color:var(--muted);
    margin:10px 0;
    padding:10px;
    border-radius:8px;
    border:1px dashed rgba(255,255,255,0.1);
    background:rgba(255,255,255,0.02);
    width:100%;
}

/* === BOTONES DE CONTACTO MEJOR CENTRADOS === */
.contact-buttons{
    display:flex;
    justify-content:center;
    gap:20px;
    flex-wrap:wrap;
    margin-top:20px;
    width: 100%;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
}
.contact-buttons a{
    display:inline-block;
    padding:12px 20px;
    background:var(--gradient);
    border-radius:10px;
    color:#fff;
    text-decoration:none;
    font-weight:600;
    transition:all 0.3s ease;
    box-shadow:0 5px 15px rgba(198,40,40,0.3);
    flex: 1;
    min-width: 120px;
    text-align: center;
}
.contact-buttons a:hover{
    transform:translateY(-3px);
    box-shadow:0 8px 20px rgba(198,40,40,0.4);
}

/* === FILTROS MEJORADOS - M√ÅS ESPACIADOS Y ORGANIZADOS === */
.filter-controls{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:15px;
    margin-bottom:20px;
    align-items:end;
    width: 100%;
    max-width: 900px; /* Reducido para mejor centrado */
    margin: 0 auto;
}

.filter-input-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.filter-input-group label {
    font-size: 0.85rem;
    color: var(--muted);
    font-weight: 500;
}

.filter-controls input{
    width:100%;
    padding:10px 14px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.08);
    background:rgba(255,255,255,0.03);
    color:var(--text);
    transition:all 0.3s ease;
    font-size:0.9rem;
}
.filter-controls input:focus{
    border-color:var(--blue-accent);
    outline:none;
    box-shadow:0 0 0 2px rgba(33, 150, 243, 0.2);
}

.filter-input-group .filter-actions {
    display: flex;
    gap: 8px;
}

.filter-input-group button.alt {
    padding: 8px 12px;
    font-size: 0.8rem;
    white-space: nowrap;
    border-radius: 8px;
    flex: 1;
}

.filter-apply-section {
    grid-column: 1 / -1;
    display: flex;
    gap: 12px;
    justify-content: center; /* Centrado mejorado */
    margin-top: 10px;
    flex-wrap: wrap;
    width: 100%;
}

.filter-apply-section button {
    min-width: 140px;
}

/* === FORMULARIO DE NOTICIAS MEJOR CENTRADO === */
#createNewsForm {
    max-width: 800px;
    width: 100%;
    margin: 0 auto 30px auto;
}

#createNewsForm textarea {
    width: 100%;
    padding: 12px 16px;
    margin: 10px 0;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.03);
    color: var(--text);
    height: 140px;
    resize: vertical;
    font-family: inherit;
    transition: all 0.3s ease;
}
#createNewsForm textarea:focus {
    border-color: var(--blue-accent);
    outline: none;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
    background: rgba(255,255,255,0.05);
}

/* Centrar el bot√≥n CREAR NOTICIA */
#btnToggleNewsForm {
    display: block;
    margin: 0 auto 20px auto;
    max-width: 200px;
}

/* === CENTRAR SECCIONES ESPEC√çFICAS === */
#documents, #images {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
}

#documents > h2, 
#images > h2, 
#news > h2, 
#contact > h2 {
    text-align: center;
    width: 100%;
}

/* Centrar los formularios de upload */
#documents input[type="file"],
#documents input[type="text"],
#documents button,
#images input[type="file"],
#images input[type="text"],
#images button {
    max-width: 500px;
    width: 100%;
}

/* Centrar la grid de documentos e im√°genes */
#documents .grid,
#images .grid {
    width: 100%;
    max-width: 1200px;
    justify-content: center;
}

/* === MOBILE ADJUSTMENTS - MEJORADO === */
@media(max-width:768px){
    .container {
        padding: 16px;
        max-width: 100%;
    }
    
    /* NAVEGACI√ìN MEJORADA PARA M√ìVIL */
    .topbar {
        padding: 12px 16px;
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
    }
    
    .nav {
        flex-direction: column;
        width: 100%;
        gap: 12px;
    }
    
    .nav.menu {
        order: 2;
        justify-content: flex-start;
        gap: 8px;
        width: 100%;
    }
    
    .nav.user-info {
        order: 1;
        width: 100%;
        justify-content: space-between;
        margin-top: 0;
    }
    
    .brand {
        font-size: 1.1rem;
        margin-right: 0;
    }
    
    /* MEN√ö DE NAVEGACI√ìN M√ÅS COMPACTO */
    .nav .menu a {
        padding: 8px 12px;
        font-size: 0.9rem;
        flex: 1;
        min-width: 0;
        text-align: center;
    }
    
    /* CONTENIDO PRINCIPAL */
    .search-card {
        padding: 20px;
    }
    
    .search-card.row {
        flex-direction: column;
        gap: 10px;
    }
    
    .search-card input {
        width: 100%;
    }
    
    /* FILTROS MEJORADOS PARA M√ìVIL */
    .filter-controls {
        grid-template-columns: 1fr;
        gap: 12px;
    }
    
    .filter-apply-section {
        flex-direction: column;
    }
    
    .filter-apply-section button {
        min-width: 100%;
    }
    
    /* TABLA DE RESULTADOS MEJORADA */
    .results {
        overflow-x: auto;
        font-size: 0.8rem;
    }
    
    /* GRID PARA M√ìVIL */
    .grid {
        grid-template-columns: 1fr;
        gap: 16px;
    }
    
    .card-item {
        min-height: 160px;
        padding: 16px;
    }
    
    .card-item img {
        height: 140px;
    }
    
    /* NOTICIAS EN M√ìVIL */
    .news-card-wrapper {
        padding: 20px;
        grid-template-columns: 1fr;
        gap: 16px;
    }
    
    .news-image-area {
        align-items: center;
        text-align: center;
    }
    
    .news-image-area img {
        max-width: 100%;
        max-height: 180px;
    }
    
    .news-list .item {
        padding: 16px;
        grid-template-columns: 1fr;
        gap: 12px;
    }
    
    .news-list .item img {
        max-width: 100%;
        height: auto;
        margin: 0 auto 12px;
        display: block;
    }
    
    /* BOTONES EN M√ìVIL */
    button {
        padding: 10px 16px;
        font-size: 0.9rem;
    }
    
    .row {
        flex-direction: column;
        gap: 10px;
    }
    
    /* FORMULARIOS */
    input, textarea {
        font-size: 16px;
    }
    
    /* Centrado en m√≥vil */
    #documents input[type="file"],
    #documents input[type="text"],
    #documents button,
    #images input[type="file"],
    #images input[type="text"],
    #images button {
        max-width: 100%;
    }
    
    .contact-buttons {
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }
    
    .contact-buttons a {
        margin: 0;
        width: 100%;
    }
    
    /* FOOTER */
    .main-footer {
        padding: 12px 16px;
        font-size: 0.85rem;
        text-align: center;
    }
}

/* AJUSTES EXTRA PARA PANTALLAS MUY PEQUE√ëAS */
@media(max-width:480px){
    .auth-card {
        padding: 24px;
        margin: 10px;
    }
    
    .nav .menu a {
        padding: 6px 10px;
        font-size: 0.85rem;
    }
    
    .user-info span {
        max-width: 150px;
        font-size: 0.85rem;
    }
    
    .card-item {
        padding: 14px;
    }
    
    .news-card-wrapper h3 {
        font-size: 1.3rem;
    }
}

/* MEJORAS PARA TABLETS */
@media(min-width:769px) and (max-width:1024px){
    .container {
        padding: 20px;
        max-width: 98vw;
    }
    
    .grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    }
    
    .nav .menu a {
        padding: 8px 12px;
        font-size: 0.9rem;
    }
    
    .filter-controls {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Para pantallas muy grandes */
@media(min-width: 1400px){
    .container {
        max-width: 1300px;
    }
}

/* === FOOTER (PIE DE P√ÅGINA) === */
.main-footer{
    display:flex;
    align-items:center;
    justify-content:center; 
    padding:16px 24px;
    background:linear-gradient(90deg,rgba(20,20,20,0.95),rgba(26,26,26,0.98));
    border-top:1px solid rgba(255,255,255,0.05); 
    color:var(--muted); 
    font-size:0.9rem;
    width: 100%;
    margin-top: auto; 
    backdrop-filter:blur(10px);
}

/* Estilos adicionales para mejoras visuales */
.section h2 {
    font-size: 1.8rem;
    margin-bottom: 20px;
    color: var(--text);
    font-weight: 700;
    position: relative;
    padding-bottom: 10px;
    text-align: center;
}

.section h2:after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 3px;
    background: var(--gradient);
    border-radius: 3px;
}

.section h3 {
    font-size: 1.4rem;
    margin: 25px 0 15px;
    color: var(--text);
    font-weight: 600;
    text-align: center;
}

/* Mejoras para los estados de los botones */
button:active {
    transform: translateY(-1px);
}

button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
    box-shadow: none !important;
}

/* Efectos de transici√≥n suaves */
* {
    transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
}
</style>
    
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
<div id="app">
    <div class="auth-screen" id="authScreen">
        <div class="card auth-card">
            <h1>Log√≠stica & Inventario</h1>
            <p class="muted">Accede para informaci√≥n</p>
            <input id="name" placeholder="Nombre"/>
            <input id="email" placeholder="Correo" type="email"/>
            
            <div class="password-container">
                <input id="password" placeholder="Contrase√±a" type="password"/>
                <button class="toggle-password" id="togglePasswordBtn">üëÅÔ∏è</button>
            </div>
            
            <div class="row">
                <button id="btnRegister">Registrarse</button>
                <button id="btnLogin" class="alt">Iniciar sesi√≥n</button>
            </div>
            <br>
            <div class="row">
                <button id="btnGoogle" class="google">üë§ Iniciar con Google</button>
            </div>
            <br>
            <p class="muted small">Los datos se guardar√°n en el sistema.</p>
        </div>
    </div>

    <div id="mainApp" class="hidden">
        <header class="topbar">
            <div style="display:flex;align-items:center;gap:10px">
                <div class="brand">Log√≠stica & Inventario</div>
            </div>

            <nav class="nav" aria-label="main navigation">
                <div class="menu">
                    <a href="#" data-section="home" class="active">Inicio</a>
                    <a href="#" data-section="documents">Documentos</a>
                    <a href="#" data-section="images">Im√°genes</a>
                    <a href="#" data-section="news">Noticias</a>
                    <a href="#" data-section="contact">Contacto</a>
                </div>
                <div class="user-info">
                    <span id="userEmail"></span>
                    <button id="btnLogout" class="ghost">Cerrar sesi√≥n</button>
                </div>
            </nav>
        </header>

        <main class="container">
            
            <section id="home" class="section active-section">
    <div class="search-card">
        <h2>Buscar c√≥digo en los ultimos conteos fisicos de las tiendas.</h2>

        <div class="row filter-controls" style="margin-bottom:16px;">
             <div class="filter-input-group">
                 <input id="filterCenter" placeholder="Filtrar por Centro de Inventario" />
                 <button id="btnResetFilterCenter" class="alt" data-target="filterCenter">Limpiar</button>
             </div>
             <button id="btnFilterCenter">Aplicar Filtro de Centro</button> 
        </div>

        <div class="row" style="margin-top:12px">
            <input id="searchCode" placeholder="Ingrese c√≥digo..." autofocus />
            <button id="btnSearch">Buscar</button>
        </div>
        <div id="searchResults" class="results"></div>
    </div>
    <div class="news-card-wrapper" id="mainNews"></div>
</section>

            <section id="documents" class="section">
                <h2>Documentos</h2>
                <input type="file" id="docFile"/>
                <input id="docName" placeholder=" * Nombre del archivo" />
                <br>
                <br>
                <button id="btnUploadDoc">Subir documento</button>
                <div id="docStatus"></div>
                
                <h3 style="margin-top:30px;margin-bottom:15px">Archivos subidos</h3>
                <div class="filter-controls">
                    <div class="filter-input-group">
                        <label for="filterNameDoc">Filtrar por usuario</label>
                        <input id="filterNameDoc" placeholder="Nombre de usuario" />
                        <div class="filter-actions">
                            <button id="btnResetFilterNameDoc" class="alt" data-target="filterNameDoc">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-input-group">
                        <label for="filterEmailDoc">Filtrar por correo</label>
                        <input id="filterEmailDoc" placeholder="Correo electr√≥nico" />
                        <div class="filter-actions">
                            <button id="btnResetFilterEmailDoc" class="alt" data-target="filterEmailDoc">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-input-group">
                        <label for="filterDateDoc">Filtrar por fecha</label>
                        <input id="filterDateDoc" placeholder="dd/mm/yyyy" />
                        <div class="filter-actions">
                            <button id="btnResetFilterDateDoc" class="alt" data-target="filterDateDoc">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-input-group">
                        <label for="filterFileNameDoc">Filtrar por nombre</label>
                        <input type="text" id="filterFileNameDoc" placeholder="Nombre del documento">
                        <div class="filter-actions">
                            <button class="alt" id="btnResetFilterFileNameDoc" data-target="filterFileNameDoc">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-apply-section">
                        <button id="btnFilterDoc">Aplicar Filtros</button>
                        <button id="btnResetAllDoc" class="alt">Limpiar todos</button>
                    </div>
                </div>
                <div id="docList" class="grid"></div>
            </section>

            <section id="images" class="section">
                <h2>Im√°genes</h2>
                <input type="file" id="imgFile" accept="image/*"/>
                <input id="imgName" placeholder="* Nombre de la imagen" />
                <br>
                <br>
                <button id="btnUploadImg">Subir imagen</button>
                <div id="imgStatus"></div>
                
                <h3 style="margin-top:30px;margin-bottom:15px">Im√°genes subidas</h3>
                <div class="filter-controls">
                    <div class="filter-input-group">
                        <label for="filterNameImg">Filtrar por usuario</label>
                        <input id="filterNameImg" placeholder="Nombre de usuario" />
                        <div class="filter-actions">
                            <button id="btnResetFilterNameImg" class="alt" data-target="filterNameImg">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-input-group">
                        <label for="filterEmailImg">Filtrar por correo</label>
                        <input id="filterEmailImg" placeholder="Correo electr√≥nico" />
                        <div class="filter-actions">
                            <button id="btnResetFilterEmailImg" class="alt" data-target="filterEmailImg">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-input-group">
                        <label for="filterDateImg">Filtrar por fecha</label>
                        <input id="filterDateImg" placeholder="dd/mm/yyyy" />
                        <div class="filter-actions">
                            <button id="btnResetFilterDateImg" class="alt" data-target="filterDateImg">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-input-group">
                        <label for="filterFileNameImg">Filtrar por nombre</label>
                        <input type="text" id="filterFileNameImg" placeholder="Nombre de la imagen">
                        <div class="filter-actions">
                            <button class="alt" id="btnResetFilterFileNameImg" data-target="filterFileNameImg">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-apply-section">
                        <button id="btnFilterImg">Aplicar Filtros</button>
                        <button id="btnResetAllImg" class="alt">Limpiar todos</button>
                    </div>
                </div>
                <div id="imgList" class="grid"></div>
            </section>

            <section id="news" class="section">
                <h2>Noticias</h2>
                
                <button id="btnToggleNewsForm" style="margin-bottom: 15px;">CREAR NOTICIA</button>

                <div id="createNewsForm" class="search-card hidden" style="margin-bottom: 30px;">
                    <h3>Publicar Nueva Noticia</h3>
                    
                    <input id="newsTitle" placeholder="* T√≠tulo de la Noticia" style="margin-bottom: 10px;" />
                    
                    <textarea id="newsContent" placeholder="* Contenido de la Noticia"></textarea>
                    
                    <label for="newsImgFile" style="display: block; margin-top: 10px; color: var(--muted); font-size: 0.9rem;">Imagen (opcional):</label>
                    <input type="file" id="newsImgFile" accept="image/*" style="margin-bottom: 10px;"/>
                    
                    <div class="row" style="justify-content: flex-start; margin-top: 15px;">
                        <button id="btnUploadNews">Publicar Noticia</button>
                        <button id="btnCancelNews" class="alt">Cancelar</button>
                    </div>

                    <div id="newsStatus" style="margin-top: 10px;"></div>
                </div>

                <h3 style="margin-top:20px;margin-bottom:15px">Lista de Noticias</h3>
                
                <div class="filter-controls">
                    <div class="filter-input-group">
                        <label for="filterNewsTitle">Filtrar por t√≠tulo</label>
                        <input id="filterNewsTitle" placeholder="T√≠tulo de la noticia" />
                        <div class="filter-actions">
                            <button id="btnResetFilterNewsTitle" class="alt" data-target="filterNewsTitle">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-input-group">
                        <label for="filterNewsDate">Filtrar por fecha</label>
                        <input id="filterNewsDate" placeholder="dd/mm/yyyy" />
                        <div class="filter-actions">
                            <button id="btnResetFilterNewsDate" class="alt" data-target="filterNewsDate">Limpiar</button>
                        </div>
                    </div>
                    <div class="filter-apply-section">
                        <button id="btnFilterNews">Aplicar Filtros</button>
                        <button id="btnResetNewsAll" class="alt">Limpiar todos</button>
                    </div>
                </div>
                <div id="newsList" class="news-list"></div>
            </section>

            <section id="contact" class="section">
                <h2>Contacto</h2>
                <br>
                <p>Derwin Rojas (Supervisor de inventario)</p>
                <br>
                <div class="contact-buttons">
                    <a id="waBtn" target="_blank">WhatsApp</a>
                    <a id="mailBtn" href="#">Correo</a>
                </div>
            </section>
        </main>
        
        <footer class="main-footer">
            <span>
                Log√≠stica & Inventario ¬© ¬†2025 creado por Derwin Rojas
            </span>
        </footer>
        </div>
    </div>

<script>
/* ====== CONFIG ====== */
const API_URL = 'https://script.google.com/macros/s/AKfycbzGoWmn4doU1_vDqQvWYbqg4WzW8WD6y64lI96xKYn_bGd-L1THgt3HVJJl_BprqpysTA/exec';

const firebaseConfig = {
    apiKey:"AIzaSyDpBoHiKKC7MLQHiWV9psdE3eJ4YuR66GU",
    authDomain:"pagina-dda30.firebaseapp.com",
    projectId:"pagina-dda30",
    appId:"1:14427407275:web:8cba04677fdeef39a088ee"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

// üëâ NUEVA VARIABLE GLOBAL: Almacena los resultados de la b√∫squeda de c√≥digo
let currentInventoryResults = [];
// üëâ NUEVA VARIABLE GLOBAL: Almacena las noticias cargadas para poder filtrarlas localmente
let allNewsData = [];

/* ====== Helpers (SIN CAMBIOS EN LA L√ìGICA DE URLS) ====== */

function getDriveDirectUrl(url)
{
    if (!url) return '';
    try {
        if (url.includes('uc?export=view') || url.includes('=export')) return url;
        
        let fileId = '';
        const m1 = url.match(/\/d\/([a-zA-Z0-9_-]+)/); 
        const m2 = url.match(/[?&]id=([a-zA-Z0-9_-]+)/); 

        if (m1 && m1[1]) {
            fileId = m1[1];
        } else if (m2 && m2[1]) {
            fileId = m2[1];
        }
        
        if (fileId) {
             return `https://drive.google.com/uc?export=view&id=${fileId}`; 
        }
        return url;
    } catch (e) { return url; }
}

function getDriveThumbnailUrl(url, size = 300) {
    if (!url) return '';
    
    let fileId = '';
    const m1 = url.match(/\/d\/([a-zA-Z0-9_-]+)/);
    const m2 = url.match(/[?&]id=([a-zA-Z0-9_-]+)/);

    if (m1 && m1[1]) {
        fileId = m1[1];
    } else if (m2 && m2[1]) {
        fileId = m2[1];
    }
    
    if (!fileId && url.includes('uc?export=view')) {
           const m3 = url.match(/[?&]id=([a-zA-Z0-9_-]+)/);
           if (m3 && m3[1]) fileId = m3[1];
    }

    if (fileId) {
           return `https://drive.google.com/thumbnail?id=${fileId}&sz=w${size}`; 
    }

    return url;
}

function safeString(v){return v === undefined || v === null ? '' : String(v); }

function getField(obj, ...keys) {
    for (const k of keys)
    {
        if (obj[k] !== undefined && obj[k] !== null) return obj[k];
    }
    const lowerMap = {};
    for (const p in obj) lowerMap[p.toLowerCase().replace(/[\s_]+/g, '')] = obj[p];
    for (const k of keys)
    {
        const low = k.toLowerCase().replace(/[\s_]+/g, ''); 
        if (lowerMap[low] !== undefined) return lowerMap[low];
    }
    return '';
}

/* ====== AUTH (AGREGADO: L√≥gica de ver/ocultar contrase√±a) ====== */

// Nuevo listener para el bot√≥n de alternar contrase√±a
document.getElementById('togglePasswordBtn').addEventListener('click', function() {
    const passwordInput = document.getElementById('password');
    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
    passwordInput.setAttribute('type', type);
    // Cambiar el icono
    this.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üîí'; 
});

auth.onAuthStateChanged(user => {
    if (user) {
        document.getElementById('authScreen').classList.add('hidden');
        document.getElementById('mainApp').classList.remove('hidden');
        document.getElementById('userEmail').textContent = user.email || user.displayName || '';
        loadNews();
        listUploads('documents');
    } else
    {
        document.getElementById('authScreen').classList.remove('hidden');
        document.getElementById('mainApp').classList.add('hidden');
    }
});

document.getElementById('btnRegister').addEventListener('click', async () =>
{
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const pass = document.getElementById('password').value;
    if (!name || !email || !pass) return alert('Completa todos los campos.');
    try
    {
        const userCred = await auth.createUserWithEmailAndPassword(email, pass);
        await userCred.user.updateProfile({ displayName: name });
        await callApi('registerUser', { user: { nombreDeUsuario: name, email, uid: userCred.user.uid } }); 
        alert('Registrado correctamente');
    } catch (err) { alert(err.message); }
});
document.getElementById('btnLogin').addEventListener('click', async () =>
{
    const email = document.getElementById('email').value.trim();
    const pass = document.getElementById('password').value;
    try
    { await auth.signInWithEmailAndPassword(email, pass); } catch (err) { alert(err.message); }
});
document.getElementById('btnGoogle').addEventListener('click', async () =>
{
    const provider = new firebase.auth.GoogleAuthProvider();
    try
    {
        const res = await auth.signInWithPopup(provider);
        const user = res.user;
        await callApi('registerUser', { user: { nombreDeUsuario: user.displayName, email: user.email, uid: user.uid } });
    } catch (err) { alert(err.message); }
});
document.getElementById('btnLogout').addEventListener('click',
    () => auth.signOut());

/* ====== API Helpers (SIN CAMBIOS) ====== */
async function getApi(action, params = {}) {
    const q = new URLSearchParams(Object.assign({ action }, params)).toString();
    const res = await fetch(API_URL + '?' + q);
    return res.json();
}
async function callApi(action, payload = {}) {
    // MODIFICADO: Ahora incluye 'uploadNews' como una acci√≥n sin retorno
    const isNoCors = (action === 'uploadFile' || action === 'addNews' || action === 'registerUser'); 
    const body = JSON.stringify(Object.assign({ action }, payload));
    if (isNoCors) {
        // Usamos 'no-cors' para acciones que no necesitan respuesta del App Script
        // y para evitar problemas de CORS en el registro.
        await fetch(API_URL, { method: 'POST', body, mode: 'no-cors' }); 
        return { ok: true, opaque: true };
    } else
    {
        const res = await fetch(API_URL,
            {
                method:'POST',
                headers: { 'Content-Type': 'application/json' },
                body
            });
        return res.json();
    }
}

// üëâ NUEVA FUNCI√ìN: Maneja el renderizado aplicando el filtro de Centro de Inventario
function renderInventoryResults() {
    const out = document.getElementById('searchResults');
    // Usamos 'filterCenter' que es el ID del input 
    const centroFilter = (document.getElementById('filterCenter')?.value || '').trim().toLowerCase(); 
    
    // Aplicar filtro por Centro_Inventario a los resultados YA OBTENIDOS
    const filtered = centroFilter 
        ? currentInventoryResults.filter(r =>
            safeString(getField(r, 'Centro_Inventario', 'centroinventario')).toLowerCase().includes(centroFilter))
        : currentInventoryResults;

    if (!filtered.length) {
        out.innerHTML = '<div class="no-results">üîç Sin resultados para este filtro</div>';
        return;
    }

    const rows = filtered.map(r => {
        const codigo = safeString(getField(r, 'codigo', 'C√≥digo', 'code')) || '';
        const nombre = safeString(getField(r, 'nombre', 'Nombre', 'name')) || '';
        const descripcion = safeString(getField(r, 'descripcion', 'Descripci√≥n', 'description')) || '';
        const um = safeString(getField(r, 'um', 'UM')) || '';
        const ubic = safeString(getField(r, 'ubicacionFisicaGeneral', 'ubicacion')) || '';
        const cantidad = safeString(getField(r, 'cantidad', 'Cant')) || '';
        const ubicExhib = safeString(getField(r, 'ubicacionExhib', 'ubicacion exhib')) || '';
        const conteo = safeString(getField(r, 'conteoExhb', 'conteo exhb')) || '';
        const fechaUlt = safeString(getField(r, 'fechaUltimoConteo', 'fecha')) || '';
        const auditor = safeString(getField(r, 'ultimoAuditor', 'auditor')) || '';
        const difG = safeString(getField(r, 'difGeneral', 'dif_general')) || '';
        const difE = safeString(getField(r, 'difExhib', 'dif_exhib')) || '';
        const centro = safeString(getField(r, 'Centro_Inventario', 'centroinventario')) || '';
        const nombreDoc = safeString(getField(r, 'Nombre_Documento', 'nombredocumento')) || '';

        // SOLUCI√ìN 1: Aplicar clase para diferencias negativas
        const claseDifG = difG.startsWith('-') ? 'class="negative-diff"' : '';
        const claseDifE = difE.startsWith('-') ? 'class="negative-diff"' : '';

        return `<tr>
            <td>${codigo}</td>
            <td>${nombre}</td>
            <td>${descripcion}</td>
            <td>${um}</td>
            <td>${ubic}</td>
            <td>${cantidad}</td>
            <td>${ubicExhib}</td>
            <td>${conteo}</td>
            <td>${fechaUlt}</td>
            <td>${auditor}</td>
            <td ${claseDifG}>${difG}</td>
            <td ${claseDifE}>${difE}</td>
            <td>${centro}</td>
            <td>${nombreDoc}</td>
        </tr>`;
    }).join('');

    out.innerHTML = `<div class="table-container">
    <div class="results-table-container">
        <table class="inventory-table">
            <thead>
                <tr>
                    <th>C√≥digo</th><th>Nombre</th><th>Descripci√≥n</th><th>UM</th>
                    <th>Ubicaci√≥n F√≠sica</th><th>Cantidad</th><th>Ubicaci√≥n Exhib</th><th>Conteo Exhib</th>
                    <th>Fecha √öltimo Conteo</th><th>Auditor</th><th>DIF General</th><th>DIF Exhib</th>
                    <th>Centro Inventario</th><th>Nombre Documento</th>
                </tr>
            </thead>
            <tbody>${rows}</tbody>
        </table>
    </div>
</div>`;
}

// üëâ MODIFICACI√ìN DE LA FUNCI√ìN btnSearch
document.getElementById('btnSearch').addEventListener('click', async () =>
{
    const code = document.getElementById('searchCode').value.trim();
    if (!code) return alert('Ingrese un c√≥digo.');

    // SOLUCI√ìN 3: Mostrar loading state
    document.getElementById('searchResults').innerHTML = '<div class="loading-results">üîç Buscando en el inventario...</div>';
    
    // Eliminamos el filtro de Centro de Inventario de aqu√≠, solo traemos los datos
    
    const data = await getApi('search', { code });

    if (data && data.results && data.results.length)
    {
        // 1. GUARDAMOS LOS RESULTADOS ORIGINALES
        currentInventoryResults = data.results;
        
        // 2. RENDERIZAMOS (APLICANDO EL FILTRO, si ya tiene valor)
        renderInventoryResults();
        
    } else {
        currentInventoryResults = [];
        document.getElementById('searchResults').innerHTML = '<div class="no-results">üîç Sin resultados</div>';
    }
});

// üëâ NUEVO: Buscar con Enter en el campo de c√≥digo
document.getElementById('searchCode').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        document.getElementById('btnSearch').click();
    }
});

// üëâ NUEVO LISTENER: Conecta el bot√≥n de filtrar con la funci√≥n de renderizado
document.getElementById('btnFilterCenter').addEventListener('click', renderInventoryResults);

// üëâ NUEVO: Filtrar con Enter en el campo de Centro de Inventario
document.getElementById('filterCenter').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        renderInventoryResults();
    }
});

// üëâ NUEVO LISTENER: Limpia el filtro de Centro de Inventario y re-renderiza
document.getElementById('btnResetFilterCenter').addEventListener('click', () => {
    document.getElementById('filterCenter').value = '';
    renderInventoryResults();
});
    
/* ====== UPLOAD helpers (SIN CAMBIOS EN LA BASE) ====== */
async function uploadFile(file, filenameOpt) {
    const base64 = await new Promise(res => {
        const r = new FileReader();
        r.onload = e => res(e.target.result.split(',')[1]);
        r.readAsDataURL(file);
    });
    const uploaderName = auth.currentUser?.displayName || ""; 
    const uploaderEmail = auth.currentUser?.email || "";
    return callApi('uploadFile',
        {
            filename: filenameOpt || file.name,
            mimeType: file.type,
            base64,
            nombreDeUsuario: uploaderName, 
            uploaderEmail 
        });
}

/* Subir documento (CON MODIFICACI√ìN: Limpiar campos despu√©s de subir) */
document.getElementById('btnUploadDoc').addEventListener('click', async () =>
{
    const f = document.getElementById('docFile');
    const name = document.getElementById('docName').value.trim();
    if (!f.files.length) return alert('Selecciona un archivo');
    if (!name) return alert('El nombre del documento es obligatorio');
    document.getElementById('docStatus').textContent = 'Subiendo...';
    try
    {
        await uploadFile(f.files[0], name);
        document.getElementById('docStatus').textContent = 'Documento subido. Recargando lista...';
        await listUploads('documents');
        document.getElementById('docStatus').textContent = 'Subido: ' + name;
        
        // üëâ NUEVO: Limpiar campos despu√©s de subir exitosamente
        document.getElementById('docFile').value = '';
        document.getElementById('docName').value = '';
        
    } catch (e) {
        document.getElementById('docStatus').textContent = 'Error al subir';
        console.error(e);
    }
});

/* Subir imagen (CON MODIFICACI√ìN: Limpiar campos despu√©s de subir) */
document.getElementById('btnUploadImg').addEventListener('click', async () =>
{
    const f = document.getElementById('imgFile');
    const name = document.getElementById('imgName').value.trim();
    if (!f.files.length) return alert('Selecciona una imagen');
    if (!name) return alert('El nombre de la imagen es obligatorio');
    document.getElementById('imgStatus').textContent = 'Subiendo...';
    try
    {
        await uploadFile(f.files[0], name);
        document.getElementById('imgStatus').textContent = 'Imagen subida. Recargando lista...';
        await listUploads('images');
        document.getElementById('imgStatus').textContent = 'Subido: ' + name;
        
        // üëâ NUEVO: Limpiar campos despu√©s de subir exitosamente
        document.getElementById('imgFile').value = '';
        document.getElementById('imgName').value = '';
        
    } catch (e) {
        document.getElementById('imgStatus').textContent = 'Error al subir';
        console.error(e);
    }
});

/* ====== FILTROS MEJORADOS - FUNCIONALIDAD COMPLETA ====== */

// Funci√≥n para limpiar todos los filtros de una secci√≥n
function resetAllFilters(section) {
    if (section === 'documents') {
        document.getElementById('filterNameDoc').value = '';
        document.getElementById('filterEmailDoc').value = '';
        document.getElementById('filterDateDoc').value = '';
        document.getElementById('filterFileNameDoc').value = '';
        listUploads('documents', false, '', true);
    } else if (section === 'images') {
        document.getElementById('filterNameImg').value = '';
        document.getElementById('filterEmailImg').value = '';
        document.getElementById('filterDateImg').value = '';
        document.getElementById('filterFileNameImg').value = '';
        listUploads('images', false, '', true);
    } else if (section === 'news') {
        document.getElementById('filterNewsTitle').value = '';
        document.getElementById('filterNewsDate').value = '';
        renderNews(allNewsData);
    }
}

// Funci√≥n auxiliar para limpiar un filtro y re-listar
function resetFilter(targetId, section) {
    document.getElementById(targetId).value = '';
    listUploads(section, false, '', true);
}

// Listeners de los botones de Limpiar Filtro - Documentos
document.getElementById('btnResetFilterNameDoc').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'documents'));
document.getElementById('btnResetFilterEmailDoc').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'documents'));
document.getElementById('btnResetFilterDateDoc').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'documents'));
document.getElementById('btnResetFilterFileNameDoc').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'documents'));

// Listeners de los botones de Limpiar Filtro - Im√°genes
document.getElementById('btnResetFilterNameImg').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'images'));
document.getElementById('btnResetFilterEmailImg').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'images'));
document.getElementById('btnResetFilterDateImg').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'images'));
document.getElementById('btnResetFilterFileNameImg').addEventListener('click', (e) => resetFilter(e.target.dataset.target, 'images'));

// Listeners para los nuevos botones "Limpiar todos"
document.getElementById('btnResetAllDoc').addEventListener('click', () => resetAllFilters('documents'));
document.getElementById('btnResetAllImg').addEventListener('click', () => resetAllFilters('images'));

document.getElementById('btnFilterDoc').addEventListener('click', () => listUploads('documents', false, '', true));
document.getElementById('btnFilterImg').addEventListener('click', () => listUploads('images', false, '', true));

// üëâ NUEVO: Aplicar filtros con Enter en todos los campos de filtro de Documentos
document.getElementById('filterNameDoc').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('documents', false, '', true);
    }
});
document.getElementById('filterEmailDoc').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('documents', false, '', true);
    }
});
document.getElementById('filterDateDoc').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('documents', false, '', true);
    }
});
document.getElementById('filterFileNameDoc').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('documents', false, '', true);
    }
});

// üëâ NUEVO: Aplicar filtros con Enter en todos los campos de filtro de Im√°genes
document.getElementById('filterNameImg').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('images', false, '', true);
    }
});
document.getElementById('filterEmailImg').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('images', false, '', true);
    }
});
document.getElementById('filterDateImg').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('images', false, '', true);
    }
});
document.getElementById('filterFileNameImg').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        listUploads('images', false, '', true);
    }
});

async function listUploads(section = 'documents', findAndShowName = false, findName = '', showLoading = false)
{
    const docList = document.getElementById('docList');
    const imgList = document.getElementById('imgList');

    // üëâ NUEVO: Mostrar "Filtrando..." si se solicita
    if (showLoading) {
        if (section === 'documents') {
            docList.innerHTML = '<div class="loading-results">üîç Filtrando documentos...</div>';
        } else if (section === 'images') {
            imgList.innerHTML = '<div class="loading-results">üîç Filtrando im√°genes...</div>';
        }
    }

    const res = await getApi('listUploads');
    const docs = res.docs || [];
    const imgs = res.imgs || [];

    let nameFilter, emailFilter, dateFilter, fileNameFilter;

    if (section === 'documents') {
        nameFilter = (document.getElementById('filterNameDoc')?.value || '').trim().toLowerCase();
        emailFilter = (document.getElementById('filterEmailDoc')?.value || '').trim().toLowerCase();
        dateFilter = (document.getElementById('filterDateDoc')?.value || '').trim();
        fileNameFilter = (document.getElementById('filterFileNameDoc')?.value || '').trim().toLowerCase();
    } else if (section === 'images') {
        nameFilter = (document.getElementById('filterNameImg')?.value || '').trim().toLowerCase();
        emailFilter = (document.getElementById('filterEmailImg')?.value || '').trim().toLowerCase();
        dateFilter = (document.getElementById('filterDateImg')?.value || '').trim();
        fileNameFilter = (document.getElementById('filterFileNameImg')?.value || '').trim().toLowerCase();
    } else {
        nameFilter = ''; emailFilter = ''; dateFilter = ''; fileNameFilter = '';
    }
    
    const filterFn = x => {
        const n = (x.uploaderName || '').toString().toLowerCase();
        const e = (x.uploaderEmail || '').toString().toLowerCase();
        const f = (x.name || '').toString().toLowerCase();
        return (
            (!nameFilter || n.includes(nameFilter)) && 
            (!emailFilter || e.includes(emailFilter)) && 
            (!dateFilter || x.date === dateFilter) &&
            (!fileNameFilter || f.includes(fileNameFilter))
        );
    };

    const filteredDocs = docs.filter(filterFn);
    
    // üëâ MODIFICACI√ìN CLAVE: Filtrar im√°genes que NO empiecen con "NEWS_"
    const filteredImgs = imgs.filter(x => {
        // Excluir im√°genes que empiezan con "NEWS_" (im√°genes de noticias)
        if (x.name && x.name.startsWith('NEWS_')) {
            return false;
        }
        return filterFn(x);
    });

    // Render documentos
    if (filteredDocs.length)
    {
        docList.innerHTML = filteredDocs.map(d => {
            const direct = getDriveDirectUrl(d.url); 
            return `<div class="card-item">
                <div style="flex:0 0 auto">
                    <a href="${direct}" target="_blank" style="font-weight:bold;color:#cce;font-size:1.1rem">${d.name}</a>
                </div>
                <div style="font-size:0.8rem;color:var(--muted);margin-top:10px">
                    üìÖ ${safeString(d.date)}<br>üë§ ${safeString(d.uploaderName) || 'Sin nombre'}<br>‚úâÔ∏è ${safeString(d.uploaderEmail) || 'Sin correo'}
                </div>
            </div>`;
        }).join('');
    } else
    {
        docList.innerHTML = '<div class="no-results">Sin documentos</div>';
    }

    // Render im√°genes (l√≥gica de URL de miniatura se mantiene)
    if (filteredImgs.length)
    {
        imgList.innerHTML = filteredImgs.map(i => {
            const thumbnail = getDriveThumbnailUrl(i.url, 400); 
            const directUrl = getDriveDirectUrl(i.url); 
            
            return `<div class="card-item">
                <a href="${directUrl}" target="_blank" style="display:block">
                    <img loading="lazy" src="${thumbnail}" alt="${i.name}" class="card-item-img"
                        onerror="this.onerror=null;this.style.display='none';this.insertAdjacentHTML('afterend','<div class=&quot;placeholder&quot;>Sin miniatura</div>');"
                    />
                </a>
                <div style="margin-top:5px;font-weight:bold;color:#ccc;font-size:1.1rem">${i.name}</div>
                <div style="font-size:0.8rem;color:var(--muted);margin-top:6px">
                    üìÖ ${safeString(i.date)}<br>üë§ ${safeString(i.uploaderName) || 'Sin nombre'}<br>‚úâÔ∏è ${safeString(i.uploaderEmail) || 'Sin correo'}
                </div>
            </div>`;
        }).join('');
    } else
    {
        imgList.innerHTML = '<div class="no-results">Sin im√°genes</div>';
    }

    if (findAndShowName && findName)
    {
        const allFiles = [...docs, ...imgs];
        const found = allFiles.find(x => x.name === findName);
        if (found) {
            const directUrl = getDriveDirectUrl(found.url);
            const isImg = (found.mime && found.mime.toLowerCase().startsWith('image/')) || /\.(jpg|jpeg|png|gif|webp)$/i.test(found.name);
            if (isImg) document.getElementById('imgStatus').innerHTML = `Subida: <a href="${directUrl}" target="_blank">Abrir</a>`;
            else document.getElementById('docStatus').innerHTML = `Subido: <a href="${directUrl}" target="_blank">Abrir</a>`;
        } else
        {
            document.getElementById('imgStatus').textContent = '';
            document.getElementById('docStatus').textContent = '';
        }
    }
}

/* ====== NEW: News Upload (Formulario) ====== */

// 1. Mostrar/Ocultar el formulario de noticias
document.getElementById('btnToggleNewsForm').addEventListener('click', () => {
    document.getElementById('createNewsForm').classList.toggle('hidden');
    // Limpiar campos al mostrar
    if (!document.getElementById('createNewsForm').classList.contains('hidden')) {
        document.getElementById('newsTitle').value = '';
        document.getElementById('newsContent').value = '';
        document.getElementById('newsImgFile').value = '';
        document.getElementById('newsStatus').textContent = '';
    }
});

document.getElementById('btnCancelNews').addEventListener('click', () => {
    document.getElementById('createNewsForm').classList.add('hidden');
});

// 2. L√≥gica para subir la Noticia
document.getElementById('btnUploadNews').addEventListener('click', async () =>
{
    const title = document.getElementById('newsTitle').value.trim();
    const content = document.getElementById('newsContent').value.trim();
    const imgFile = document.getElementById('newsImgFile').files[0];
    const status = document.getElementById('newsStatus');

    if (!title || !content) return alert('El T√≠tulo y el Contenido son obligatorios.');

    status.textContent = 'Subiendo noticia...';

    let imageUrl = '';

    try
    {
        // 1. Subir la imagen si existe
        if (imgFile) {
            status.textContent = 'Subiendo imagen...';
            // Usamos un nombre √∫nico para la imagen de noticia para evitar colisiones
            const imgName = `NEWS_${Date.now()}_${imgFile.name}`; 
            
            // Llama al Apps Script para subir la imagen a Drive/Sheet de archivos
            await uploadFile(imgFile, imgName);

            // Dado que 'uploadFile' usa 'mode: no-cors', necesitamos un paso adicional para obtener el URL
            // Hacemos una nueva llamada a la API para obtener el listado de im√°genes y buscar la reci√©n subida
            const listRes = await getApi('listUploads');
            const uploadedImg = (listRes.imgs || []).find(x => x.name === imgName);
            if (uploadedImg && uploadedImg.url) {
                imageUrl = uploadedImg.url;
            } else {
                status.textContent = 'Error: No se pudo obtener el URL de la imagen. La noticia se publicar√° sin ella.';
                console.warn('Could not retrieve image URL after upload.');
            }
        }
        
        // 2. Publicar la noticia con los datos (y el URL de la imagen)
        status.textContent = 'Publicando noticia..';
        
        const newsData = {
            titulo: title,
            contenido: content,
            imagenUrl: imageUrl,
        };

        // Nueva acci√≥n en Apps Script: 'addNews'
        await callApi('addNews', { news: newsData });

        status.textContent = '‚úÖ Noticia publicada exitosamente. Recargando lista...';
        
        // Limpiar formulario y recargar noticias
        document.getElementById('createNewsForm').classList.add('hidden');
        await loadNews();

    } catch (e) {
        status.textContent = '‚ùå Error al publicar la noticia.';
        console.error(e);
    }
});

/* ====== Noticias (L√ìGICA MEJORADA PARA MOSTRAR Y FILTRAR) ====== */

function renderNews(newsArray) {
    const main = document.getElementById('mainNews');
    const list = document.getElementById('newsList');

    if (newsArray.length === 0) {
        main.innerHTML = '<div class="no-results">No se han publicado noticias.</div>';
        list.innerHTML = '';
        return;
    }

    // 1. Renderizado de la NOTICIA PRINCIPAL (si hay resultados)
    const n = newsArray[0];
    const imgUrl = getDriveThumbnailUrl(safeString(n.imagenUrl), 300); 
    const directLink = getDriveDirectUrl(safeString(n.imagenUrl));

    main.innerHTML = `
        <div class="news-image-area">
            ${imgUrl 
                ? `<a href="${directLink}" target="_blank"><img loading="lazy" src="${imgUrl}" alt="noticia" class="news-card-img" 
                    onerror="this.style.display='none'; this.alt='No image'"></a>` 
                : ''}
            <div class="news-meta-data">
                üìÖ ${safeString(n.fecha)}
            </div>
        </div>
        <div class='news-content-area'>
            <h3>${safeString(n.titulo)}</h3>
            <p style="margin-top:10px">${safeString(n.contenido)}</p>
        </div>
        `; 

    // 2. Renderizado de la LISTA DE NOTICIAS
    list.innerHTML = newsArray.map(x => {
        const thumb = getDriveThumbnailUrl(safeString(x.imagenUrl), 200); 
        const directLinkItem = getDriveDirectUrl(safeString(x.imagenUrl));
        
        return `<div class="item">
            <a href="${directLinkItem}" target="_blank">
            ${thumb
                ? `<img loading="lazy" src="${thumb}" alt="${safeString(x.titulo)}" class="news-list-thumb"
                    onerror="this.style.display='none'; this.alt='No image'">`
                : ''}
            </a>
            <div>
                <strong>${safeString(x.titulo)}</strong>
                <small>${safeString(x.fecha)}</small>
                <p>${safeString(x.contenido)}</p> 
            </div>
        </div>`;
    }).join('');
}

async function loadNews(){
    const res = await getApi('listNews');
    
    // Almacena los resultados originales de la API
    allNewsData = (res && res.news && res.news.length) ? res.news : [];
    
    // Renderiza la lista completa inicialmente
    renderNews(allNewsData);
}

// 3. NEW: News Filtering Logic
function filterNews() {
    const titleFilter = (document.getElementById('filterNewsTitle')?.value || '').trim().toLowerCase();
    const dateFilter = (document.getElementById('filterNewsDate')?.value || '').trim();

    const filteredNews = allNewsData.filter(n => {
        const title = (n.titulo || '').toString().toLowerCase();
        const date = (n.fecha || '').toString().trim();
        
        return (
            (!titleFilter || title.includes(titleFilter)) && 
            // Buscamos si la fecha empieza con el filtro (√∫til para buscar por dd/mm o dd/mm/yyyy)
            (!dateFilter || date.startsWith(dateFilter))
        );
    });

    renderNews(filteredNews);
}

// 4. NEW: Listeners para los filtros y limpieza
document.getElementById('btnFilterNews').addEventListener('click', filterNews);

// üëâ NUEVO: Filtrar noticias con Enter
document.getElementById('filterNewsTitle').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        filterNews();
    }
});
document.getElementById('filterNewsDate').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        filterNews();
    }
});

// Limpiar filtro individual de T√≠tulo
document.getElementById('btnResetFilterNewsTitle').addEventListener('click', (e) => {
    document.getElementById(e.target.dataset.target).value = '';
    filterNews(); 
});

// Limpiar filtro individual de Fecha
document.getElementById('btnResetFilterNewsDate').addEventListener('click', (e) => {
    document.getElementById(e.target.dataset.target).value = '';
    filterNews(); 
});

// Limpiar TODOS los filtros de Noticias
document.getElementById('btnResetNewsAll').addEventListener('click', () => {
    document.getElementById('filterNewsTitle').value = '';
    document.getElementById('filterNewsDate').value = '';
    renderNews(allNewsData); // Muestra todos los resultados almacenados
});


/* ====== NAVEGACI√ìN CON RESETEO DE SCROLL ====== */
document.querySelectorAll('.nav a').forEach(a => {
    a.addEventListener('click', e => {
        e.preventDefault();
        
        // Remover active de todos los enlaces
        document.querySelectorAll('.nav a').forEach(n => n.classList.remove('active'));
        // Agregar active al enlace clickeado
        a.classList.add('active');
        
        const target = a.dataset.section;
        // Ocultar todas las secciones
        document.querySelectorAll('.section').forEach(s => {
            s.classList.remove('active-section');
        });
        // Mostrar solo la secci√≥n objetivo
        document.getElementById(target).classList.add('active-section');
        
        // üî• RESETEAR EL SCROLL A LA PARTE SUPERIOR
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
        
        // Tambi√©n resetear el scroll del contenedor principal si es necesario
        const container = document.querySelector('.container');
        if (container) {
            container.scrollTop = 0;
        }
        
        // Cargar contenido espec√≠fico de cada secci√≥n
        if (target === 'documents') listUploads('documents'); 
        if (target === 'images') listUploads('images');
        if (target === 'home') loadNews();
        
        // Si la secci√≥n es "home", enfocar el campo de c√≥digo
        if (target === 'home') {
            setTimeout(function() {
                const searchCodeInput = document.getElementById('searchCode');
                if (searchCodeInput) {
                    searchCodeInput.focus();
                }
            }, 100);
        }
    });
});

/* ====== Contacto (SIN CAMBIOS) */
document.getElementById('waBtn').href = "https://wa.me/4129915255?text=Hola%20";
document.getElementById('mailBtn').href = "mailto:derwins.rojas@kacosa.com";

/* ====== Inicial (SIN CAMBIOS) ====== */
setTimeout(() => {if (auth.currentUser) { listUploads('documents'); listUploads('images'); loadNews(); } }, 800);

// üëâ NUEVO: Limpiar resultados cuando la barra de b√∫squeda quede vac√≠a
document.getElementById('searchCode').addEventListener('input', function() {
    const code = this.value.trim();
    if (!code) {
        // Si la barra de b√∫squeda est√° vac√≠a, limpiar los resultados
        currentInventoryResults = [];
        document.getElementById('searchResults').innerHTML = '';
    }
});

// üëâ NUEVO: Limpiar resultados filtrados cuando el filtro de Centro quede vac√≠o
document.getElementById('filterCenter').addEventListener('input', function() {
    const filterValue = this.value.trim();
    if (!filterValue && currentInventoryResults.length > 0) {
        // Si el filtro est√° vac√≠o pero hay resultados, mostrar todos los resultados nuevamente
        renderInventoryResults();
    }
});

// üëâ NUEVO: Limpiar resultados cuando los filtros de nombre de archivo queden vac√≠os
document.getElementById('filterFileNameDoc').addEventListener('input', function() {
    const filterValue = this.value.trim();
    if (!filterValue) {
        listUploads('documents', false, '', true);
    }
});

document.getElementById('filterFileNameImg').addEventListener('input', function() {
    const filterValue = this.value.trim();
    if (!filterValue) {
        listUploads('images', false, '', true);
    }
});

/* === AUTO-FOCUS FORZADO EN M√ìVIL === */
function focusSearchField() {
    const searchCodeInput = document.getElementById('searchCode');
    if (searchCodeInput && document.getElementById('home').classList.contains('active-section')) {
        searchCodeInput.focus();
        
        setTimeout(() => {
            searchCodeInput.focus();
        }, 500);
    }
}

// Enfocar cuando la p√°gina cargue
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(focusSearchField, 300);
});

// Tambi√©n enfocar cuando se cambie a la secci√≥n de inicio
document.querySelectorAll('.nav a').forEach(a => {
    a.addEventListener('click', function(e) {
        // ... el c√≥digo de navegaci√≥n que ya tienes ...
        
        setTimeout(function() {
            if (this.dataset.section === 'home') {
                focusSearchField();
            }
        }.bind(this), 100);
    });
});

</script>

</body>
</html>
